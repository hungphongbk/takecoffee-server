// Generated by CoffeeScript 1.10.0
(function() {
  (function($) {
    $.openDialogAjax = function(url, target, css, events) {
      if (css == null) {
        css = null;
      }
      if (events == null) {
        events = null;
      }
      return $.ajax({
        type: 'GET',
        url: url,
        success: function(data) {
          var $childTarget, childEvent, childTarget, dialog, e, f;
          target = $(target);
          target.find('.modal-content').html(data);
          if (css) {
            dialog = target.find('.modal-dialog');
            dialog.css(css);
          }
          if (events) {
            for (e in events) {
              f = events[e];
              if (e.indexOf('->') === -1) {
                target.on(e, f);
              } else {
                childTarget = e.split('->');
                $childTarget = $(childTarget[0].trim());
                childEvent = childTarget[1].trim();
                $childTarget.on(childEvent, f);
              }
            }
          }
          target.modal('show');
        },
        error: function() {
          return alert('failure');
        }
      });
    };
    return $.fn.extend({
      extendedFileInput: function(url) {
        return this.each(function() {
          var $btnSelectExisting, $existingId, $form, $inputType, $selectDialog, $this, showSelectDialog, toggleInputType;
          $this = $(this);
          $form = $this.closest('form')[0];
          $inputType = $form['upload_type'];
          $existingId = $form['existing_id'];
          $btnSelectExisting = $this.find('.select-existing');
          $selectDialog = $('#selectModal');
          toggleInputType = function(value) {
            return $($inputType).val(value);
          };
          showSelectDialog = function() {
            var css;
            css = {
              'margin-top': '60px'
            };
            return $.openDialogAjax(url, $selectDialog, css, {
              'shown.bs.modal': function(e) {
                var $dialog, selectable;
                $dialog = $(e.target);
                selectable = $dialog.find('.ui-selectable');
                selectable.selectable({
                  stop: function() {
                    var id;
                    id = $('.ui-selected').data('id');
                  }
                });
              },
              'hidden.bs.modal': function() {
                $(this).data('bs.modal', null);
              },
              '.select-btn->click': function() {
                alert('fuck you');
              }
            });
          };
          $this.on('change.bs.fileinput', function() {
            return toggleInputType(0);
          });
          $btnSelectExisting.on('click', function() {
            return showSelectDialog();
          });
        });
      }
    });
  })(jQuery);

}).call(this);

//# sourceMappingURL=script.js.map
